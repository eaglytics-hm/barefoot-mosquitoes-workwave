import Joi from 'joi';

import { BooleanField, Int64Field, NumericField, RecordField, StringField, DateTimeField } from '../schema';
import { createWebhookModel } from '../webhook.interface';

const PdfUrlFields = {
    AdditionalProp1: StringField,
    AdditionalProp2: StringField,
    AdditionalProp3: StringField,
    Invoice: StringField,
    InspectionReport: StringField,
};

const TaxDetailsFields = {
    CountryOfTax: StringField,
    TaxLabel: StringField,
    TaxRate: NumericField,
    TaxAmount: NumericField,
};

const UserDefinedFields = {
    FieldNum: Int64Field,
    Caption: StringField,
    Value: StringField,
    Description: StringField,
    Type: StringField,
    Show: BooleanField,
    TableName: StringField,
};

const ApplicationFields = {
    PaymentID: Int64Field,
    BillToID: Int64Field,
    BatchNumber: Int64Field,
    BranchID: Int64Field,
    Branch: StringField,
    PaymentDate: DateTimeField,
    Amount: NumericField,
    Balance: NumericField,
    Reference: StringField,
    MethodOfPayment: StringField,
    GLCode: StringField,
    Service: StringField,
    ServiceDescription: StringField,
    Committed: BooleanField,
    FinanceID: BooleanField,
    PaymentType: StringField,
    AdjustmentReason: StringField,
    RelatedPaymentID: Int64Field,
};

export const InvoiceCreditMemo = createWebhookModel({
    name: 'Invoice',
    resolver: (id) => ({ method: 'GET', url: `invoices/${id}` }),
    schema: Joi.object({
        InvoiceID: Int64Field,
        LocationID: Int64Field,
        BillToID: Int64Field,
        SetupID: Int64Field,
        InvoiceNumber: StringField,
        OrderNumber: StringField,
        Branch: StringField,
        BranchID: Int64Field,
        ServiceLocation: {
            Company: StringField,
            LName: StringField,
            FName: StringField,
            Title: StringField,
            Address: StringField,
            Address2: StringField,
            City: StringField,
            State: StringField,
            Zip: StringField,
        },
        BillTo: {
            Company: StringField,
            LName: StringField,
            FName: StringField,
            Title: StringField,
            Address: StringField,
            Address2: StringField,
            City: StringField,
            State: StringField,
            Zip: StringField,
        },
        ServiceCode: StringField,
        Description: StringField,
        TaxRate: NumericField,
        SubTotal: NumericField,
        Tax: NumericField,
        TaxDetails: Joi.array().has(TaxDetailsFields),
        Total: NumericField,
        Balance: NumericField,
        Cost: NumericField,
        InvoiceDate: DateTimeField,
        WorkDate: DateTimeField,
        DueDate: DateTimeField,
        TimeRange: StringField,
        Duration: NumericField,
        InvoiceType: StringField,
        OrderType: StringField,
        SetupType: StringField,
        OrderDate: DateTimeField,
        Origin: StringField,
        Route: StringField,
        Measurement: NumericField,
        MeasurementType: StringField,
        TaxCode: StringField,
        PurchaseOrderNumber: StringField,
        Division: StringField,
        Source: StringField,
        GLCode: StringField,
        ParentInvoiceID: Int64Field,
        LocationInstructions: StringField,
        ServiceInstructions: StringField,
        OrderInstructions: StringField,
        TechnicianComment: StringField,
        Printed: BooleanField,
        PrintedDate: DateTimeField,
        Terms: StringField,
        CreditMemoReason: StringField,
        TaxOnlyCreditMemo: BooleanField,
        BatchNumber: Int64Field,
        Void: BooleanField,
        NotServicedReason: StringField,
        ConsolidatedInvoiceNum: StringField,
        ConsolidatedInvoiceDate: DateTimeField,
        LineItems: Joi.array().has({
            ServiceCode: StringField,
            Description: StringField,
            Cost: NumericField,
            UnitPrice: NumericField,
            Quantity: NumericField,
            ExtendedPrice: NumericField,
            Taxable: BooleanField,
            GLCode: StringField,
        }),
        MaterialApplications: Joi.array().has({
            MaterialApplicationID: Int64Field,
            OrderID: Int64Field,
            OrderNum: Int64Field,
            InvoiceID: Int64Field,
            InvoiceNum: Int64Field,
            LocationID: Int64Field,
            MaterialID: Int64Field,
            MaterialCode: StringField,
            MaterialName: StringField,
            LotNumber: StringField,
            EPARegistration: StringField,
            Quantity: NumericField,
            UnitOfMeasure: StringField,
            UndilutedQuantity: NumericField,
            UndilutedUnitOfMeasure: StringField,
            ActiveIngredient: StringField,
            ActiveIngredientPercentage: NumericField,
            ActiveIngredientConcentration: NumericField,
            ApplicationRate: StringField,
            ApplicationMethod: StringField,
            ApplicationEquipment: StringField,
            SkyCondition: StringField,
            AirTemperature: NumericField,
            WindVelocity: NumericField,
            WindDirection: StringField,
            LinearFeet: NumericField,
            SquareFeet: NumericField,
            CubicFeet: NumericField,
            Comment: StringField,
            Technician: StringField,
            TechnicianName: StringField,
            Device: StringField,
            WorkDate: DateTimeField,
            DateApplied: DateTimeField,
            AreasApplied: Joi.array().has(StringField),
            TargetPests: Joi.array().has(StringField),
            TargetPestDescriptions: Joi.array().has(StringField),
        }),
        TargetPests: Joi.array().has(StringField),
        Technicians: Joi.array().has({
            Position: Int64Field,
            TechID: Int64Field,
            Code: StringField,
            FirstName: StringField,
            LastName: StringField,
            Commission: NumericField,
            Bonus: NumericField,
            Share: NumericField,
            NoCommission: BooleanField,
            SignatureFilename: StringField,
            Username: StringField,
        }),
        UserDefinedFields: Joi.array().has(UserDefinedFields),
        PdfUrls: PdfUrlFields,
        Applications: Joi.array().has({
            ApplyFromType: StringField,
            ApplyFromID: Int64Field,
            Amount: NumericField,
            Committed: BooleanField,
            Payment: ApplicationFields,
            Adjustment: ApplicationFields,
            CreditMemo: {
                InvoiceID: Int64Field,
                LocationID: Int64Field,
                BillToID: Int64Field,
                SetupID: Int64Field,
                InvoiceNumber: StringField,
                Branch: StringField,
                BranchID: Int64Field,
                ParentInvoiceID: Int64Field,
                ServiceCode: StringField,
                Description: StringField,
                SubTotal: NumericField,
                Tax: NumericField,
                TaxDetails: Joi.array().has(TaxDetailsFields),
                Total: NumericField,
                Balance: NumericField,
                InvoiceDate: DateTimeField,
                WorkDate: DateTimeField,
                DueDate: DateTimeField,
                Duration: NumericField,
                TimeRange: StringField,
                InvoiceType: StringField,
                Origin: StringField,
                Tech1: StringField,
                TechID1: Int64Field,
                Route: StringField,
                ConsolidatedInvoiceNum: StringField,
                ConsolidatedInvoiceDate: DateTimeField,
                PdfUrls: PdfUrlFields,
                AutoBill: BooleanField,
                BundleName: StringField,
                DiscountCode: StringField,
                LocationBundleID: Int64Field,
                OrderID: Int64Field,
                OrderNumber: StringField,
                UncommittedBalance: NumericField,
                ExternalIdentifier: StringField,
            },
            PendingCreditMemo: {
                OrderID: Int64Field,
                LocationID: Int64Field,
                BillToID: Int64Field,
                SetupID: Int64Field,
                LeadID: StringField,
                OrderNumber: StringField,
                Branch: StringField,
                BranchID: Int64Field,
                ParentOrderID: Int64Field,
                LocationInstructions: StringField,
                ServiceInstructions: StringField,
                OrderInstructions: StringField,
                TechnicianComment: StringField,
                InProgress: BooleanField,
                Posted: BooleanField,
                ServiceCode: StringField,
                Description: StringField,
                SubTotal: NumericField,
                Tax: NumericField,
                TaxDetails: Joi.array().has(TaxDetailsFields),
                Total: NumericField,
                WorkDate: DateTimeField,
                TimeRange: StringField,
                Locked: BooleanField,
                Duration: NumericField,
                OrderType: StringField,
                Origin: StringField,
                Tech1: StringField,
                TechID1: Int64Field,
                Route: StringField,
                PdfUrls: PdfUrlFields,
                UserDefinedFields: Joi.array().has(UserDefinedFields),
                BundleName: StringField,
                DiscountCode: StringField,
                LocationBundleID: Int64Field,
                BatchNumber: Int64Field,
                ExternalIdentifier: StringField,
            },
            ReversePayment: ApplicationFields,
        }),
        AppliedTo: Joi.array().has({
            ApplyToType: StringField,
            ApplyToID: Int64Field,
            Amount: NumericField,
            Committed: BooleanField,
            AdjustmentReason: StringField,
            AdjustmentAmount: NumericField,
            ServiceID: Int64Field,
            Invoice: {
                InvoiceID: Int64Field,
                LocationID: Int64Field,
                BillToID: Int64Field,
                SetupID: Int64Field,
                InvoiceNumber: StringField,
                Branch: StringField,
                BranchID: Int64Field,
                ParentInvoiceID: Int64Field,
                ServiceCode: StringField,
                Description: StringField,
                SubTotal: NumericField,
                Tax: NumericField,
                TaxDetails: Joi.array().has(TaxDetailsFields),
                Total: NumericField,
                Balance: NumericField,
                InvoiceDate: DateTimeField,
                WorkDate: DateTimeField,
                DueDate: DateTimeField,
                Duration: NumericField,
                TimeRange: StringField,
                InvoiceType: StringField,
                Origin: StringField,
                Tech1: StringField,
                TechID1: Int64Field,
                Route: StringField,
                ConsolidatedInvoiceNum: StringField,
                ConsolidatedInvoiceDate: DateTimeField,
                PdfUrls: PdfUrlFields,
                AutoBill: BooleanField,
                BundleName: StringField,
                DiscountCode: StringField,
                LocationBundleID: Int64Field,
                OrderID: Int64Field,
                OrderNumber: StringField,
                UncommittedBalance: NumericField,
                ExternalIdentifier: StringField,
            },
            ServiceOrder: {
                OrderID: Int64Field,
                LocationID: Int64Field,
                BillToID: Int64Field,
                SetupID: Int64Field,
                LeadID: Int64Field,
                OrderNumber: StringField,
                Branch: StringField,
                BranchID: Int64Field,
                ParentOrderID: Int64Field,
                LocationInstructions: StringField,
                ServiceInstructions: StringField,
                OrderInstructions: StringField,
                TechnicianComment: StringField,
                InProgress: BooleanField,
                Posted: BooleanField,
                ServiceCode: StringField,
                Description: StringField,
                SubTotal: NumericField,
                Tax: NumericField,
                TaxDetails: Joi.array().has(TaxDetailsFields),
                Total: NumericField,
                WorkDate: DateTimeField,
                TimeRange: StringField,
                Locked: BooleanField,
                Duration: NumericField,
                OrderType: StringField,
                Origin: StringField,
                Tech1: StringField,
                TechID1: Int64Field,
                Route: StringField,
                PdfUrls: PdfUrlFields,
                UserDefinedFields: Joi.array().has(UserDefinedFields),
                BundleName: StringField,
                DiscountCode: StringField,
                LocationBundleID: Int64Field,
                BatchNumber: Int64Field,
                ExternalIdentifier: StringField,
            },
            ServiceSetup: {
                SetupID: Int64Field,
                ProgramID: Int64Field,
                LocationID: Int64Field,
                ServiceCode: StringField,
                DiscountPercentage: NumericField,
                AnnualAdvanceRenewal: BooleanField,
                IncludeInitial: BooleanField,
            },
            Renewal: {
                SetupID: Int64Field,
                LocationID: Int64Field,
                StartDate: DateTimeField,
                RenewalDate: DateTimeField,
                RenewalPrice: NumericField,
                CreateInvoice: BooleanField,
                InvoiceDate: DateTimeField,
                CreateServiceOrder: BooleanField,
                OrderType: StringField,
                WorkDate: DateTimeField,
                Duration: NumericField,
                TimeRange: StringField,
                Color: StringField,
                TechID1: Int64Field,
                TechBonus1: NumericField,
                TechShare1: NumericField,
                TechNoCommission1: BooleanField,
                TechID2: Int64Field,
                TechBonus2: NumericField,
                TechShare2: NumericField,
                TechNoCommission2: BooleanField,
                TechID3: Int64Field,
                TechBonus3: NumericField,
                TechShare3: NumericField,
                TechNoCommission3: BooleanField,
                TechID4: Int64Field,
                TechBonus4: NumericField,
                TechShare4: NumericField,
                TechNoCommission4: BooleanField,
                TechID5: Int64Field,
                TechBonus5: NumericField,
                TechShare5: NumericField,
                TechNoCommission5: BooleanField,
                AnnualAdvanceRenewal: BooleanField,
                RenewalInterval: NumericField,
                AdvanceRenewalOnly: BooleanField,
                RenewSetupIDs: StringField,
                AdvanceSAD: BooleanField,
                AsfSetupIDs: StringField,
            },
        }),
        BundleName: StringField,
        DiscountCode: StringField,
        OpportunityId: Int64Field,
        LocationBundleID: Int64Field,
        OrderID: Int64Field,
        ExternalIdentifier: StringField,
        ServiceOrderAttributes: {
            AttributeAssignmentID: Int64Field,
            OrderID: Int64Field,
            InvoiceID: Int64Field,
            AttributeID: Int64Field,
            Category: StringField,
            Description: StringField,
            Type: StringField,
            Answer: StringField,
            YesText: StringField,
            NoText: StringField,
            CheckboxText: StringField,
        },
    }),
});
